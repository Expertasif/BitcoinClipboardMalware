#include "Clipboard.hpp"

Clipboard::Clipboard()
{

}

Clipboard::~Clipboard()
{

}

std::string Clipboard::getClipboard()
{
    std::string text = "error";
    if(OpenClipboard(NULL))
    {
        HANDLE hData = GetClipboardData(CF_TEXT);
        if(hData != NULL)
        {
            text = static_cast<char *>(GlobalLock(hData));
    		GlobalUnlock(hData);
        }

        CloseClipboard();
    }

    return text;
}

void Clipboard::setClipboard(std::string contentsToSet)
{
    if(OpenClipboard(NULL))
    {
        HGLOBAL clipbuffer;
        char * buffer;
        EmptyClipboard();
        clipbuffer = GlobalAlloc(GMEM_DDESHARE, contentsToSet.length() + 1);
        buffer = (char*)GlobalLock(clipbuffer);
        strcpy(buffer, LPCSTR(contentsToSet.c_str()));
        GlobalUnlock(clipbuffer);
        SetClipboardData(CF_TEXT,clipbuffer);
        CloseClipboard();
    }
}
